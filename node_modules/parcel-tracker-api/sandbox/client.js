const {Tracker} = require('../dist/index');

const config = {
    enableCrossOrigin: true,
    apiKeys: {
        laPoste: 'Q3kDbaq+r73FmR+FGP9kP+MhKQQ10z5F34tcQBQc0dlhJIb2WJ8Tnt7OB7NL/A4C',
        DHL: 'yG3nXMO0PYqJ9ZDVyzieWotnPJHuCEQi',
        royalMail: 'e4cca01c-5734-498f-9b57-80f87d8c07d8;I4bE3hQ7dV0dC7eH5uM1bB4iA5wV4oN7aV3lO8cX3dF5kC1yS4',
    }
};

const tracker = new Tracker(config);

window.onload = () => {
    const getCarrierButton = document.getElementById('carrier-button');
    const trackingNumberInput = document.getElementById('tracking-number');
    const carrierDiv = document.getElementById('carrier');
    const carrierList = document.getElementById('carrier-list');
    const getInformationButton = document.getElementById('submit');
    const responseDiv = document.getElementById('response');

    for (let i = 0; i < tracker.getCarriersList().length; i++) {
        let option = document.createElement("option");
        option.value = tracker.getCarriersList()[i];
        option.text = tracker.getCarriersList()[i];
        carrierList.appendChild(option);
    }

    getCarrierButton.onclick = () => {
        carrierDiv.innerHTML = tracker.getCarrier(trackingNumberInput.value);
    };

    getInformationButton.onclick = () => {
        const number = trackingNumberInput.value;

        const carrier = carrierList.options[carrierList.selectedIndex].value;

        try {
            tracker.getTrackingInformations(number, carrier).then((response) => {
                responseDiv.innerHTML = JSON.stringify(response, null, 2)
            }).catch((e) => {
                console.error(e);
                responseDiv.innerHTML = e;
            });
        } catch (e) {
            console.error(e);
            responseDiv.innerHTML = e;
        }
    }
}